<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:41px; margin-bottom:14px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:x-large; color:#111111; background-color:#ffffff;">Deny user login by locking out account</span></p>
<p style=" margin-top:0px; margin-bottom:27px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:27px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111; background-color:#ffffff;">Pass -l option to passwd command. It is used to lock the specified account and it is available to root only. The locking is performed by rendering the encrypted password into an invalid string and by prefixing the encrypted string with an !.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:27px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:large; font-weight:600; color:#111111; background-color:#ffffff;">Syntax</span></p>
<p style=" margin-top:0px; margin-bottom:27px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:27px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111; background-color:#ffffff;">passwd -l {</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#993399;">username</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111;">}</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:27px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:large; font-weight:600; color:#111111; background-color:#ffffff;">Unlock account or allow login</span></p>
<p style=" margin-top:0px; margin-bottom:27px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:27px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111; background-color:#ffffff;">To allow login use passwd command as follows:</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111;"><br />passwd -u {</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#993399;">username</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111;">}</span></p>
<p style=" margin-top:0px; margin-bottom:27px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:27px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111; background-color:#ffffff;">This is the reverse of the -l option â€“ it will unlock the account password by removing the ! prefix.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:27px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:large; font-weight:600; color:#111111; background-color:#ffffff;">/sbin/nologin shell</span></p>
<p style=" margin-top:0px; margin-bottom:27px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:27px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111; background-color:#ffffff;">/sbin/nologin displays a message that an account is not available and exits non-zero. It is intended as a replacement shell field for accounts that have been disabled or login is blocked.</span></p>
<p style=" margin-top:41px; margin-bottom:14px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:x-large; color:#111111; background-color:#ffffff;">Example: Deny login for tom user</span></p>
<p style=" margin-top:0px; margin-bottom:27px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:27px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111; background-color:#ffffff;">Type the command as follows (login as root user):</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111;"><br /></span><span style=" font-family:'Consolas,Monaco,Menlo,Courier,Verdana,sans-serif'; font-size:16px; color:#666666; background-color:#fafbfc;"># passwd -l tom</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111;"><br />You can also change shell to /sbin/nologin:<br /></span><span style=" font-family:'Consolas,Monaco,Menlo,Courier,Verdana,sans-serif'; font-size:16px; color:#666666; background-color:#fafbfc;"># usermod -s /sbin/nologin tom</span></p>
<p style=" margin-top:41px; margin-bottom:14px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:x-large; color:#111111; background-color:#ffffff;">Example: Allog login for tom user</span></p>
<p style=" margin-top:0px; margin-bottom:27px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:27px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111; background-color:#ffffff;">Type the command as follows (login as root user):</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111;"><br /></span><span style=" font-family:'Consolas,Monaco,Menlo,Courier,Verdana,sans-serif'; font-size:16px; color:#666666; background-color:#fafbfc;"># passwd -u tom</span><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111;"><br />You can also need change back shell from /sbin/nologin to /bin/bash:<br /></span><span style=" font-family:'Consolas,Monaco,Menlo,Courier,Verdana,sans-serif'; font-size:16px; color:#666666; background-color:#fafbfc;"># usermod -s /bin/bash tom</span></p>
<p style=" margin-top:0px; margin-bottom:27px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:27px; background-color:#ffffff;"><span style=" font-family:'Arial,Helvetica Neue,Helvetica,sans-serif'; font-size:16px; color:#111111; background-color:#ffffff;">For more information and other options read passwd command man page.</span></p></body></html>