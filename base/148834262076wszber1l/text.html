<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">This tutorial was created using information from the following sites:<br /><a href="http://www.ubuntu-howto.info/howto/how-to-connect-with-ssh-without-using-a-password"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">Connecting SSH Without Using A Password</span></a><br /><a href="http://ubuntuforums.org/archive/index.php/t-97532.html"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">How To Automount SSHFS Filesystems Automatically at Startup</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Background</span><br />There are two reasons why I did this. The first is that I constantly move files back and forth between systems using the command line, and SSHFS is the easiest way to do it. The second is that I am connecting my XBMC's together using MySQL for the database, but thumbnail files need to stay in the .xbmc/userdata folder on each machine. This will also setup an easy rsync without having to create an SSH connection on the fly.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">SSH Passwordless Login</span><br />This could be a whole section by itself, but it is so simple I'll just include it for now. This will share public keys between systems so you don't have to enter a password when connecting with the same username. It's fairly simple, but does require some command line work.</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Make sure you have SSH installed on both systems. If you don't, type this in the command line:<br /></li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;">sudo apt-get install ssh</p>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Generate the public and private keys for your computer<br /></li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;">ssh-keygen -t rsa</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;">This command creates two files in your /home/user/.ssh/ directory, id_rsa and id_rsa.pub. id_rsa.pub is your <span style=" font-weight:600;">public key</span> and you can give this to anyone you trust. id_rsa is your <span style=" font-weight:600;">private key</span>, which is not for sharing. At all. Ever. </p>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Copy your <span style=" font-weight:600;">public key</span> to the remote computer you want to connect to. I used FileZilla because I had it open, but you can use SCP if you want:<br /></li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;">scp ~/.ssh/id_rsa.pub [username]@[remotecomputer]:~/.ssh/id_rsa_[localcomputer].pub</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;">Obviously replace [username], [remotecomputer], and [localcomputer] with the appropriate names.</p>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Log into the remote host (this is the last time you will have to use your password!) and add your public key to the authorized_keys2:<br /></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;">cd .ssh &amp;&amp; cat id_rsa_localbox.pub &gt;&gt; authorized_keys2 &amp;&amp; rm id_rsa_localbox.pub</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">That's it! Do the same from the remote computer side if you want to have a two-way passwordless authentication between computers. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Automounting SSHFS</span><br />For most Linux systems, you mount using fstab. This is a tried and true way of mounting local and remote shares. I've done it a couple times with samba, and very often with local drives. The problem with this method is that it won't wait until the network is up and running, and your SSHFS mounts will fail. The easy fix is to run after the network starts up. This script does just that.</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Create a new shell script<br /></li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;">sudo nano connectsshfs.sh</p>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">In the shell script, paste the following code:<br /></li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;">ip=XXX.XXX.XXX.XXX # Replace with your IP address or DNS name<br />user=user<br /># Replace with your username<br />dir=/path/on/remote/computer # Replace with the directory on the remote computer<br />r=1<br />c=0<br />until [ $r = 0 ]<br />do<br />if test $c -gt 120<br />then<br />exit 1<br />fi<br />ping -c 2 $ip<br />r=$?<br /><br />c=`expr $c + 1`<br />sleep 5<br />done<br />sshfs $user@$ip:$dir /path/to/local/folder # Replace with your local folder path<br /></p>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Change the information in the script to match your network setup</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Save the script (if you are using nano, ctrl+x and hit enter to save)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Set the script as executable<br /></li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;">sudo chmod a+x connectsshfs.sh</p>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Move the script to your user/bin folder<br /></li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;">sudo mv connectsshfs.sh /usr/bin/</p>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Back in the GUI, click on Menu&gt;Preferences&gt;Startup Programs (this is for Linux Mint, for Ubuntu go to System&gt;Preferences&gt;Sessions)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Click the <span style=" font-style:italic;">add</span> button and fill in any name for the title, and /usr/bin/connectsshfs.sh as the program to run</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Click <span style=" font-style:italic;">Close</span></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Your SSHFS drives are now mounted at startup, and because of the public key authentication between computers you will not be prompted for a password. Simple, huh? </p></body></html>